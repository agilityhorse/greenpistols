<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Green Pistols</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <img src="images/logogp.png" alt="Green Pistols Logo" class="logo" />
        <h1>GREEN PISTOLS</h1>
        <p class="tagline">The only brand that pays its animal models.</p>
      </header>

      <section class="product-image">
        <img src="images/socks.png" alt="Green Revenge Socks" />
      </section>

      <section class="foundation">
        <p>
          November donations will directly support the
          <a href="https://snowleopard.org/"
            ><strong>Snow Leopard Trust</strong></a
          >. Your money will help fight for the rights and protection of our
          big, beautiful white cats.
        </p>
      </section>

      <section class="price-breakdown">
        <pre>
whole price included:

€3 → donation to foundation
€3 → pair of socks
€3 → worldwide shipping
      </pre
        >
      </section>
      
      <section class="subscription">
        <p class="price">€9 / month subscription</p>
        <button class="cta" id="joinBtn">JOIN THE REBELLION</button>
      </section>

      <div id="emailModal" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <h2>We’re not ready yet</h2>
          <p>
            We’re not ready yet, but leave your email and we’ll notify you when
            we start accepting orders.
          </p>
          <form id="emailForm">
            <input
              type="email"
              name="email"
              placeholder="Your email"
              required
            />
            <button type="submit" class="cta">Submit</button>
          </form>
          <p id="responseMsg" style="font-size: 12px; margin-top: 10px"></p>
        </div>
      </div>

      <section class="how-it-works">
        <p>
          One pair of socks every month.<br />
          Worldwide delivery. Transparent donations.
        </p>
      </section>

      <footer>
        <p>
          <a href="aboutme.html">About Me</a> |
          <a href="https://www.instagram.com/greenpistolscom">Instagram</a> |
          <a href="https://x.com/greenpistolscom">X</a> |
          <a href="https://agilityhorse.github.io/greenpistols/">Tik Tok</a>
        </p>
      </footer>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const modal = document.getElementById("emailModal");
        const btn = document.getElementById("joinBtn");
        const span = document.querySelector(".close");
        const form = document.getElementById("emailForm");
        const responseMsg = document.getElementById("responseMsg");

        // Twój URL do Apps Script (wklej tu dokładny /exec URL)
        const APPS_SCRIPT_URL =
          "https://script.google.com/macros/s/AKfycbz8PEjFIdkOtNoYqGQ3REZhCCfovIYqvaf5-sLozcIRLLm5KrjzCOmP_rZRU_ZZcE81/exec";

        // Funkcja do wysyłania danych do Apps Script (POST x-www-form-urlencoded)
        function postToSheets(params) {
          // params powinien być stringiem "a=1&b=2" lub URLSearchParams
          fetch(APPS_SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: params,
          })
            .then((res) => res.text())
            .then((text) => {
              // opcjonalnie: debug w konsoli
              // console.log('AppsScript response:', text);
            })
            .catch((err) => {
              console.warn("Logging to Sheets failed:", err);
            });
        }

        // Obsługa kliknięcia przycisku — logujemy klik i otwieramy modal
        btn.addEventListener("click", function (e) {
          // nie blokujemy interakcji — logujemy asynchronicznie
          const params =
            "action=click&label=" +
            encodeURIComponent("joinBtn") +
            "&page=" +
            encodeURIComponent(location.pathname || "index");
          postToSheets(params);

          // otwórz modal
          modal.style.display = "block";
        });

        // Zamknięcie po kliknięciu w X
        span.addEventListener("click", function () {
          modal.style.display = "none";
        });

        // Zamknięcie po kliknięciu poza modal
        window.addEventListener("click", function (event) {
          if (event.target === modal) {
            modal.style.display = "none";
          }
        });

        // Obsługa formularza email (jak wcześniej)
        form.addEventListener("submit", function (e) {
          e.preventDefault();
          const email = form.email.value.trim();
          if (!email) return;

          const params = "email=" + encodeURIComponent(email);
          fetch(APPS_SCRIPT_URL, {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: params,
          })
            .then((res) => res.text())
            .then((text) => {
              if (text && text.indexOf("SUCCESS") !== -1) {
                responseMsg.textContent =
                  "✅ Thanks! Your email has been saved.";
                form.reset();
              } else {
                responseMsg.textContent = "⚠️ Something went wrong: " + text;
              }
            })
            .catch((err) => {
              responseMsg.textContent = "❌ Error: " + err;
            });
        });
      });
    </script>
  </body>
</html>




